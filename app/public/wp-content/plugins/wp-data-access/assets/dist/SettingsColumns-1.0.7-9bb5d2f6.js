import{j as e,co as K,l as u,ba as Y,aC as Z,cp as $,r as M,bJ as R,bP as p,cq as I,bh as ee,cr as se,cs as te,ct as ie,cu as ae,z as x,cv as ne,cw as re,cx as oe,cy as le,cz as de,cA as ce}from"./main-1.0.7.js";import{u as w,S as me,a as pe,I as U,b as ue,c as ge,d as _,D as xe,e as he,f as je,g as fe,h as be,T as ye,M as Se,P as ke}from"./useMetadataColumns-1.0.7-004f6707.js";import{u as k,B as g,b as G,M as D,a as ve,a7 as Ne,a8 as Te,a9 as Ae,q as Ee,aa as Pe,ab as Me,ac as we,ad as De,ae as Fe,af as Le,D as Ce}from"./main-1.0.7-9bcf9658.js";import{h as Oe}from"./index.esm-1.0.7-50dfbcc7.js";import{S as f,a as N,C as Re}from"./settings-1.0.7-0ed115b6.js";import{u as v}from"./useTableUpdater-1.0.7-8b30420d.js";import{b as A,F as y,a as S,T as P,A as Ue}from"./TextField-1.0.7-db52d17f.js";import{a as H}from"./ScopeEnum-1.0.7-801b5acc.js";import{P as V}from"./PremiumFeature-1.0.7-7accbda7.js";import{b as _e,c as Be,a as Ge}from"./index.esm-1.0.7-c2078752.js";import{A as F,a as L,b as C}from"./AccordionSummary-1.0.7-07dc4067.js";import{F as b}from"./FormControlLabel-1.0.7-e4e2218b.js";import{R as Ve}from"./RadioGroup-1.0.7-a99aad94.js";import{R as B}from"./Radio-1.0.7-a1fc902e.js";import{A as h,a as j}from"./TableContainer-1.0.7-a612d45b.js";import{C as ze}from"./Checkbox-1.0.7-e4c93e2e.js";import{I as T}from"./iconBase-1.0.7-dd244ceb.js";import"./useStoreTable-1.0.7-4bf15352.js";import"./AdminTheme-1.0.7-e1a0758c.js";import"./ActionsDml-1.0.7-c9050d88.js";import"./MenuItem-1.0.7-c593e11a.js";import"./index-1.0.7-22a4f547.js";import"./Stepper-1.0.7-be2bc3e5.js";import"./Close-1.0.7-d2499b42.js";import"./DialogContent-1.0.7-fca1f4d6.js";import"./Tabs-1.0.7-766143ea.js";import"./useSlot-1.0.7-9849c4eb.js";import"./index.esm-1.0.7-790ca268.js";import"./AlertTitle-1.0.7-a2e806c7.js";import"./InputAdornment-1.0.7-45f92a3b.js";import"./DateTimePicker-1.0.7-ba971b5e.js";import"./useMobilePicker-1.0.7-72dd8d81.js";import"./date-time-utils-1.0.7-4bd69471.js";import"./dateViewRenderers-1.0.7-95ec4b9e.js";import"./TimePicker-1.0.7-a475013a.js";import"./DatePicker-1.0.7-438b5afb.js";import"./useAppLanguage-1.0.7-7d769d48.js";import"./index-1.0.7-2cb350a7.js";const He=({appId:i,columnIndex:o,tableColumn:s})=>{const a=k(),d=v(i);return e.jsxs(g,{sx:{margin:"0 1rem 2rem 1rem"},children:[e.jsx(A,{children:"Width"}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(H,{min:60,max:420,step:1,value:s.width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(t,l)=>{a(K({appId:i,index:o,width:l})),d(!0),t.stopPropagation()}}),e.jsx("span",{children:"px"})]})]})},We=({appId:i,columnIndex:o,tableColumn:s})=>{var l,n;u.debug(i,o,s),k();const a=Y(Z.getState(),i);w(i,a);const d=G(c=>$(c,i));M.useState(!1),v(i);const t=!0;return e.jsxs(F,{disableGutters:!0,children:[e.jsxs(L,{expandIcon:e.jsx(D,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(_e,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column actions"})]}),e.jsxs(C,{sx:{display:"grid",paddingTop:"1rem"},children:[e.jsxs(g,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto"},children:[s.computedField?e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0}),label:"Enable inline search",labelPlacement:"end"}):e.jsx(b,{control:e.jsx(f,{checked:s.inlineSearch&&!t,disabled:t,onChange:(c,E)=>{c.stopPropagation()}}),label:"Enable column filtering",labelPlacement:"end"}),s.inlineSearch&&!t&&e.jsxs(g,{children:[e.jsxs(Ve,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"20px",marginTop:"10px",marginBottom:"10px"},children:[e.jsxs(A,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.SEARCHBOX,disabled:!0,onChange:c=>{c.stopPropagation()}}),"Searchbox"]}),e.jsxs(A,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.DROPDOWN,disabled:!0,onChange:c=>{c.stopPropagation()}}),"Drop-down list"]}),e.jsxs(A,{className:"align-label-radio",children:[e.jsx(B,{checked:s.inlineSearchEnum===R.MULTISELECT,disabled:!0,onChange:c=>{c.stopPropagation()}}),"Multi-select drop-down list"]})]}),e.jsx(e.Fragment,{children:s.lookup!==void 0&&((l=s.lookup)==null?void 0:l.loadOnStartup)!==!0&&e.jsx(y,{sx:{marginBottom:"20px"},children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ve,{size:"24px"}),e.jsx("span",{children:"Drop-down list are only supported for lookups loaded into memory on startup."})]})})})]}),((n=a==null?void 0:a.privs)==null?void 0:n.update)&&a.primary_key.length>0&&e.jsx(e.Fragment,{children:!s.computedField&&!s.columnName.startsWith("d.")?e.jsx(b,{control:e.jsx(f,{checked:d&&s.visible&&s.inlineEditing,disabled:!0,onChange:(c,E)=>{c.stopPropagation()}}),label:"Enable inline editing",labelPlacement:"end"}):e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0}),label:"Enable inline editing",labelPlacement:"end"})})]}),!1,e.jsx(V,{})]})]})},qe=({appId:i,columnIndex:o,tableColumn:s})=>{const a=k(),d=v(i),t=w(i),l=(n,c)=>{u.debug(n,c)};return e.jsxs(F,{disableGutters:!0,children:[e.jsxs(L,{expandIcon:e.jsx(D,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Be,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(C,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[!s.computedField&&t[s.columnName]!==void 0&&p(t[s.columnName].data_type)==="string"&&t[s.columnName].data_type!=="enum"&&t[s.columnName].data_type!=="set"&&e.jsxs(y,{children:[e.jsx(b,{control:e.jsx(f,{checked:s.allowMarkup,onChange:(n,c)=>{a(I({appId:i,index:o,allowMarkup:c})),d(!0),n.stopPropagation()}}),label:"Allow inline HTML",labelPlacement:"end"}),e.jsx(S,{children:"Allows users to use markup in column content. Enabling this feature can generate cross-site scripting (XSS) messages."})]}),e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto"},children:[e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0,onClick:n=>{l(o,!s.visibleTablet),n.stopPropagation()}}),label:"Show column on tablet",labelPlacement:"end"}),e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Show column on mobile",labelPlacement:"end"})]}),(s.computedField||t[s.columnName]!==void 0&&(p(t[s.columnName].data_type)==="float"||p(t[s.columnName].data_type)==="number"||p(t[s.columnName].data_type)==="time"||p(t[s.columnName].data_type,!0)==="datetime"||p(t[s.columnName].data_type,!0)==="timestamp"))&&e.jsx(g,{children:e.jsxs(y,{children:[e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Localize",labelPlacement:"end"}),e.jsx(S,{children:s.computedField||t[s.columnName]!==void 0&&(p(t[s.columnName].data_type)==="float"||p(t[s.columnName].data_type)==="number")?"Localizes decimal and thousands seperators (does not affect inline fields)":"Localizes date and time fields  (does not affect inline fields)"})]})}),(t[s.columnName]!==void 0&&p(t[s.columnName].data_type,!0)==="float"||s.computedField!==void 0)&&e.jsxs(y,{children:[e.jsx(A,{children:"Decimals"}),e.jsx(H,{min:0,max:6,value:s.decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"âˆž"}],valueLabelDisplay:"auto",disabled:!0,onChange:(n,c)=>{u.debug(c),n.stopPropagation()}}),e.jsx(S,{children:"Number of decimals displayed"})]}),t[s.columnName]!==void 0&&s.localize&&(p(t[s.columnName].data_type,!0)==="datetime"||p(t[s.columnName].data_type,!0)==="timestamp")&&e.jsx(g,{children:p(t[s.columnName].data_type)==="date"&&e.jsx(y,{children:e.jsx(b,{control:e.jsx(f,{checked:!1,disabled:!0,onClick:n=>{n.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})})}),e.jsxs(y,{children:[e.jsxs(g,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(P,{type:"text",variant:"outlined",label:"Prefix",value:s.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(P,{type:"text",variant:"outlined",label:"Suffix",value:s.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}})]}),e.jsx(S,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)"})]}),e.jsxs(y,{children:[e.jsx(P,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:s.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:n=>{n.stopPropagation()}}),e.jsx(S,{children:"CSS classes (seperated by spaces) for custom styling"})]}),e.jsx(V,{single:!1,margin:"0"})]})]})},Qe=[{key:h.SUM,label:j.SUM},{key:h.MIN,label:j.MIN},{key:h.MAX,label:j.MAX},{key:h.AVG,label:j.AVG},{key:h.COUNT,label:j.COUNT},{key:h.UNIQUE,label:j.UNIQUE},{key:h.STD,label:j.STD},{key:h.VARIANCE,label:j.VARIANCE},{key:h.MEDIAN,label:j.MEDIAN}],z=[...Qe],Xe=({appId:i,columnIndex:o,tableColumn:s})=>{u.debug(i,o,s),k(),v(i);const a=w(i),d=M.useMemo(()=>{var t;return(s==null?void 0:s.aggregation)===void 0?[]:(t=s==null?void 0:s.aggregation)==null?void 0:t.map(l=>z.filter(n=>n.key===l)[0])},[s==null?void 0:s.aggregation]);return!ee(i)||s.computedField===void 0&&p(a[s.columnName].data_type)!=="number"?null:e.jsxs(F,{disableGutters:!0,children:[e.jsxs(L,{expandIcon:e.jsx(D,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ge,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Aggregations"})]}),e.jsxs(C,{sx:{marginTop:"10px"},children:[e.jsxs(y,{fullWidth:!0,children:[e.jsx(Ue,{multiple:!0,options:z,disabled:!0,disableCloseOnSelect:!0,getOptionLabel:t=>t.label,value:d,onChange:(t,l)=>{t.stopPropagation()},renderOption:(t,l,{selected:n})=>e.jsxs("li",{...t,children:[e.jsx(ze,{icon:e.jsx(Ne,{}),checkedIcon:e.jsx(Te,{}),style:{marginRight:8},checked:n}),l.label]}),renderInput:t=>e.jsx(P,{...t,label:"Select from list"})}),e.jsx(S,{children:"Allows multiple selections. Displayed in order of entry."})]}),e.jsx(V,{})]})]})},Je=({appId:i,columnIndex:o,tableColumn:s})=>{u.debug(i,o,s);const a=k(),d=v(i),l=w(i)[s.columnName],n=(c,E)=>{a(se({appId:i,columnName:s.columnName})),a(te({appId:i,columnName:s.columnName})),a(ie({appId:i,index:c,lookup:E})),d(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(He,{appId:i,columnIndex:o,tableColumn:s}),e.jsx(qe,{appId:i,columnIndex:o,tableColumn:s}),e.jsx(We,{appId:i,columnIndex:o,tableColumn:s}),e.jsx(me,{appId:i,columnIndex:o,tableColumn:s,columnMetaData:l,setLookup:n}),e.jsx(Xe,{appId:i,columnIndex:o,tableColumn:s}),e.jsx(pe,{columnMetaData:l})]})},Ke=({appId:i,columnIndex:o})=>{u.debug(i,o);const s=k(),a=G(r=>ae(r,i,o));u.debug("tableColumn",a);const d=v(i),[t,l]=M.useState(!1),[n,c]=M.useState(void 0),E=r=>{r!==void 0&&(s(ne({appId:i,index:r})),d(!0))},W=(r,m)=>{u.debug(r,m),s(re({appId:i,index:r,visible:m})),d(!0)},q=(r,m)=>{u.debug(r,m),s(oe({appId:i,index:r,queryable:m})),d(!0)},Q=(r,m)=>{u.debug(r,m),s(le({appId:i,index:r,orderable:m})),d(!0)},O=(r,m)=>{s(de({appId:i,index:r,alignment:m})),d(!0)},X=(r,m,J)=>(u.debug(r,m,J),e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{"& svg":{pointerEvents:"none",opacity:"0.5"}},children:e.jsx(ue,{id:r,enabled:!1},r)}),e.jsxs(g,{sx:{display:"inline-grid",gridTemplateColumns:a.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[a.computedField!==void 0&&e.jsx(Oe,{}),e.jsx(A,{children:m})]})]}));return e.jsxs(e.Fragment,{children:[e.jsxs(F,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(L,{className:"pp-column-settings",expandIcon:e.jsx(D,{}),sx:{justifyContent:"space-between"},children:[e.jsx(g,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:X(a.columnName,a.columnLabel,o)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(N,{title:"Visibility",position:"bottom",children:e.jsx(T,{onClick:r=>{W(o,!a.visible),r.stopPropagation()},children:e.jsx(U,{checked:a.visible,children:e.jsx(Ae,{})})})}),a.computedField?e.jsx(N,{title:"Edit",position:"bottom",children:e.jsx(T,{onClick:r=>{r.stopPropagation()},children:e.jsx(Pe,{})})}):e.jsx(N,{title:"Searchable",position:"bottom",children:e.jsx(T,{onClick:r=>{q(o,!a.queryable),r.stopPropagation()},children:e.jsx(U,{checked:a.queryable,alignRight:!1,children:e.jsx(Ee,{})})})}),a.computedField?e.jsx(N,{title:"Delete",position:"bottom",children:e.jsx(T,{onClick:r=>{c(o),l(!0),r.stopPropagation()},children:e.jsx(we,{})})}):e.jsx(N,{title:"Sortable",position:"bottom",children:e.jsx(T,{onClick:r=>{Q(o,!a.orderable),r.stopPropagation()},children:e.jsx(U,{checked:a.orderable,children:e.jsx(Me,{})})})}),e.jsx(N,{title:"Alignment",position:"bottom",children:e.jsxs(T,{onClick:r=>{a.alignment===x.LEFT?O(o,x.CENTER):a.alignment===x.CENTER?O(o,x.RIGHT):a.alignment===x.RIGHT&&O(o,x.LEFT),d(!0),r.stopPropagation()},children:[a.alignment===x.LEFT&&e.jsx(De,{}),a.alignment===x.CENTER&&e.jsx(Fe,{}),a.alignment===x.RIGHT&&e.jsx(Le,{})]})})]})]}),e.jsx(C,{children:e.jsx(Je,{appId:i,columnIndex:o,tableColumn:a})})]},o),e.jsx(Re,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:t,setOpen:l,onConfirm:()=>E(n)})]})},Cs=({appId:i,metaData:o})=>{u.debug(i,o),k();const s=ge(_(ke),_(Se),_(ye));v(i);const a=t=>{const{active:l,over:n}=t;u.debug(l,n),l==null||l.id,n==null||n.id},d=G(t=>ce(t,i));return d===void 0||d.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(xe,{autoScroll:!0,sensors:s,collisionDetection:he,onDragEnd:a,children:e.jsx(je,{items:d,children:d.map((t,l)=>e.jsx(fe,{id:t,children:e.jsx(Ke,{appId:i,columnIndex:l})},t))})}),e.jsx(be,{appId:i,target:Ce.TABLE})]})};export{Cs as default};
